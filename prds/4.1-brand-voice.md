# PRD 4.1 — Brand Voice: Advanced UI

**Phase:** 4 — Growth and Engagement
**Type:** EXPAND
**Complexity:** High
**Dependencies:** Task 2.3 (Settings refactor)

---

## Goal

Enable users to define a distinctive brand voice that the AI consistently applies, moving beyond basic text descriptions to an interactive voice configuration system.

---

## Target User

Content creator or marketing team that wants consistent brand voice across all AI-generated content.

---

## Success Metrics

- Voice profile completion rate > 70% (all sliders + archetype set)
- Playground usage > 3 previews per voice setup session
- User satisfaction with AI tone accuracy > 4/5

---

## Features

### 1. Persona Builder
Named personas with:
- Custom avatar (upload or emoji)
- Archetype selection
- Edit and delete actions per persona

### 2. Interactive Sliders
Four adjustable axes (0–100 each):
- **Formality** — Casual ↔ Professional
- **Humor** — Serious ↔ Playful
- **Technicality** — Simple ↔ Expert
- **Energy** — Calm ↔ Enthusiastic

### 3. Archetype Picker
Visual cards that pre-fill slider positions:
- Educator
- Entertainer
- Authority
- Storyteller
- Analyst
- Connector

### 4. Tone Comparison
Side-by-side panel:
- Left: user's input sample text
- Right: AI-rewritten version using current voice settings
- Updates on slider change (debounced 500ms)

### 5. Style Guide Generator
"Generate Style Guide" button:
- Produces a branded style guide document from current voice settings
- Covers vocabulary, tone rules, do/don't examples
- Downloadable as HTML or plain text

### 6. Interactive Playground
- Text area for user to enter any text
- "Preview" button to see voice applied
- Shows diff highlights of what changed

---

## Data Model Changes

```sql
ALTER TABLE voice_profiles ADD COLUMN archetype TEXT;
ALTER TABLE voice_profiles ADD COLUMN formality INTEGER DEFAULT 50;
ALTER TABLE voice_profiles ADD COLUMN humor INTEGER DEFAULT 50;
ALTER TABLE voice_profiles ADD COLUMN technicality INTEGER DEFAULT 50;
ALTER TABLE voice_profiles ADD COLUMN energy INTEGER DEFAULT 50;
ALTER TABLE voice_profiles ADD COLUMN avatar_url TEXT;
```

---

## Edge Functions

### `preview-voice`
**Input:** `{ sample_text, voice_config: { archetype, formality, humor, technicality, energy } }`
**Output:** `{ rewritten_text }`

### `generate-style-guide`
**Input:** `{ voice_profile_id }`
**Output:** `{ style_guide_html }` — vocabulary, tone rules, usage guidelines

---

## Out of Scope

- Multiple voice personas applied to different newsletter sections
- Voice analytics (which voice profile performs best)
- Competitor voice analysis

---

## Implementation Subtasks

- [ ] 4.1.1: Create DB migration: add voice profile columns
- [ ] 4.1.2: Create dedicated `pages/BrandVoicePage.tsx` (or large section in refactored Settings)
- [ ] 4.1.3: Build persona card component — avatar, name, archetype badge, edit/delete
- [ ] 4.1.4: Build archetype picker — 6 visual cards with icon, name, description; clicking pre-fills sliders
- [ ] 4.1.5: Build interactive sliders — 4 range inputs with labeled endpoints
- [ ] 4.1.6: Create edge function `preview-voice`
- [ ] 4.1.7: Build tone comparison panel — input left, AI output right, updates on slider change
- [ ] 4.1.8: Build interactive playground — text area + "Preview" button
- [ ] 4.1.9: Create edge function `generate-style-guide`
- [ ] 4.1.10: Build style guide generator with downloadable output
- [ ] 4.1.11: Update `train-voice` edge function to accept slider values and archetype
- [ ] 4.1.12: Add `api.ts` wrappers: `previewVoice()`, `generateStyleGuide()`
- [ ] 4.1.13: Add route `/brand-voice` or update Settings navigation

---

## Stitch Design References

`brand_voice:_persona_builder`, `brand_voice:_interactive_sliders`, `brand_voice:_tone_&_archetype`, `brand_voice:_tone_comparison_v2`, `brand_voice:_style_guide_v3`, `brand_voice:_interactive_play_v4`
